--- a/src/services/ExpressionParser.ts
+++ b/src/services/ExpressionParser.ts
@@ -350,8 +350,12 @@ export class ExpressionParser implements IExpressionParser {
       }
     }
 
-    if (stack.length !== 1) {
-      throw new Error('Invalid expression');
+    if (stack.length === 0) {
+      throw new Error('Invalid expression: empty result');
+    }
+    
+    if (stack.length > 1) {
+      throw new Error('Invalid expression: incomplete evaluation');
     }
 
     return stack[0];
